{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<!-- Add CSS Files Here -->

	<!-- 'styles.css' At The Top -->

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
		integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w=="
		crossorigin="anonymous" />

	<link rel="stylesheet" href="{% static '/css/styles.css' %}" />
	<link rel="stylesheet" href="{% static '/css/home.css' %}" />
	<link rel="stylesheet" href="{% static '/css/explore.css' %}" />
	<link rel="stylesheet" href="{% static '/css/explore.css' %}" />
	<link rel="stylesheet" href="{% static '/css/chat.css' %}" />
	<link rel="stylesheet" href="{% static './css/order.css' %}" />

	<!-- End CSS -->

	<title>Home - FSE</title>
</head>

<body class="homePageBody">
	<!-- ------------------------------------------- -->
	<!-- Start Header -->

	<header>
		<img class="logo" src="{% static '/images/Logo/cover.png' %}" alt="" />
	</header>

	<!-- End Header -->
	<!-- ------------------------------------------- -->
	<!-- Start Main -->

	<main class="homePage mainSection" id="homePage">
		<div class="search">
			<h3>What do you want to cook today?</h3>
			<div class="form">
				<input type="search" name="searchFood" id="searchFood" placeholder="Search For A Food Dish" />
				<button type="submit" id="submit">
					<img src="{% static '/images/search.png' %}" alt="" />
				</button>
			</div>
		</div>

		<div class="topHorizontal">
			<ul id="topHorizontal">
				<li onclick="changePannel(this, 'newest')" class="liEl active" id="newestLi">
					Newest Food
				</li>
				<li onclick="changePannel(this, 'recommended')" class="liEl">
					Chef's Recommended
				</li>
				<li onclick="changePannel(this, 'mostBid')" class="liEl">
					Best Bids
				</li>
			</ul>
		</div>

		<div class="foodHorizontal">

			<ul id="searched" class="pannel">
			</ul>

			<ul id="newest" class="pannel" style="display: block">
				{% for new in newest %}
				<a href="{% url 'showMenu' new.cuisine %}">
					<li>
						<div class="fooditem">
							<div class="foodPhoto">
								<img src="{% static '/images/Cuisines/'|add:new.cuisine|add:'.jpg' %}" alt="" />
							</div>
							<div class="content">
								<div class="like"></div>
								<div class="icon">
									<h4> ₹ {{ new.price }}</h4>
								</div>
								<section>
									<div class="bg-item"></div>
									<div class="bg-text">
										<div class="stars"></div>
										<h2>{{ new.name }}</h2>
										<h4>{{ new.cuisine }}</h4>
									</div>
								</section>
							</div>
						</div>
					</li>
				</a>
				{% endfor %}
			</ul>

			<ul id="recommended" class="pannel">
				{% for new in recommended %}
				<a href="{% url 'showMenu' new.cuisine %}">
					<li>
						<div class="fooditem">
							<div class="foodPhoto">
								<img src="{% static '/images/Cuisines/'|add:new.cuisine|add:'.jpg' %}" alt="" />
							</div>
							<div class="content">
								<div class="like"></div>
								<div class="icon">
									<h4> ₹ {{ new.price }}</h4>
								</div>
								<section>
									<div class="bg-item"></div>
									<div class="bg-text">
										<div class="stars"></div>
										<h2>{{ new.name }}</h2>
										<h4>{{ new.cuisine }}</h4>
									</div>
								</section>
							</div>
						</div>
					</li>
				</a>
				{% endfor %}
			</ul>

			<ul id="mostBid" class="pannel">
				{% for mostbid in recommended_drink %}
				<a href="{% url 'showBarMenu' mostbid.drinktype %}">
					<li>
						<div class="fooditem">
							<div class="foodPhoto">
								<img src="{% static '/images/Cuisines/'|add:mostbid.drinktype|add:'.jpg' %}" alt="" />
							</div>
							<div class="content">
								<div class="like"></div>
								<div class="icon">
									<h4> ₹ {{ mostbid.current_price }}</h4>
								</div>
								<section>
									<div class="bg-item"></div>
									<div class="bg-text">
										<div class="stars"></div>
										<h2>{{ mostbid.name }}</h2>
										<h4>{{ mostbid.drinktype }}</h4>
									</div>
								</section>
							</div>
						</div>
					</li>
				</a>
				{% endfor %}
			</ul>
		</div>
	</main>

	<!-- Explore Page Starts here -->
	<main class="explorePage mainSection" id="explorePage">
		<div class="explore heading">
			<span class="headingName">Explore</span>
		</div>
		<div class="topHorizontal">
			<ul>
				<li onclick="exploreSwitch(this, 'switchfood')" id="foodTab" class="exploreTab active">
					Food
				</li>

				<li onclick="exploreSwitch(this, 'switchdrink')" id="drinkTab" class="exploreTab">
					Drinks
				</li>
			</ul>
		</div>
		<div class="cuisinelisting">
			<div class="cusines food active" id="switchfood">
				{% for cuisine in allcuisine %}

				<a href="{% url 'showMenu' cuisine.cuisine %}">
					<div class="cuisine1">
						<div class="photo">
							<img class="cusinecover" src="{% static '/images/Cuisines/'|add:cuisine.cuisine|add:'-2.jpg' %}" alt="" />
						</div>
						<div class="label">
							<div class="bg-item"></div>
							<div class="label-cuisine">
								<h4>{{ cuisine.cuisine }}</h4>
							</div>

						</div>
					</div>
				</a>

				{% endfor %}
			</div>

			<div class="cusines drink" id="switchdrink">
				{% for drink in alldrinks %}

				<a href="{% url 'showBarMenu' drink.drinktype %}">
					<div class="cuisine1">
						<div class="photo">
							<img class="cusinecover" src="{% static '/images/Cuisines/'|add:drink.drinktype|add:'-2.jpg' %}" alt="" />
						</div>
						<div class="label">
							<h4>{{drink.drinktype}}</h4>
						</div>
					</div>
				</a>

				{% endfor %}
			</div>
		</div>
	</main>
	<!-- Explore Page Ends here -->

	<!-- ChatBot Page Starts here -->
	<main class="chatBotPage mainSection active" id="chatBotPage">
		<div class="intro">
			<h1>Bar Stock Exchange</h1>
			<span style="color: #3bb43b;">Online</span>
		</div>
		<div class="chattingArea messages-area">
			<br />
			{% for message in messages %}
			<div class="chat 
			    {{message.className}}">
				<p>{{message.message}}</p>
			</div>
			<br />
			{% endfor %}
			<br />

			<!-- {% for i in allChat %}

			<div class="chat {{i.className}}">
				<p>{{i.text}}</p>
			</div>
			<br />

			{% endfor %} -->
		</div>
		<!-- <div class="input-area">
			<input type="text" id="message-input">
			<button id="send-btn">Send</button>
		</div> -->
		<div class="chatUser" id="chatButtons">
			<button class="noBtn" id="noBtn">
				<p>No</p>
			</button>
			<button class="yesBtn" id="yesBtn">
				<p>Yes</p>
			</button>
		</div>
	</main>
	<!-- chat Page Ends here -->

	<!-- Orders Page Starts here -->
	<main class="orderPage mainSection" id="orderPage">
		<!-- <div class="heading">
			<span class="headingName">Order</span>
		</div>

		<div class="orderGrid">
			<table cellspacing="10">
				<col width="45%" />
				<col width="1%" />
				<col width="30%" />
				<col width="40%" />
				<tr>
					<th>Dish Name</th>
					<th>Qty</th>
					<th></th>
					<th>Amount</th>
				</tr>

				{% for order in all_ordered %}
				<tr>
					<td>{{order.dish_name}}</td>
					<td>{{order.qty}}</td>
					{% if order.cooked %}
					<td class="eat"><span></span>Eat</td>
					{% else %}
					<td class="cook"><span></span>Cook</td>
					{% endif %}
					<td>
						<img src="{% static '/images/rupee.png' %}" alt="" />{{order.price}}
					</td>
				</tr>
				{% endfor %}
				<tr>
					<td>Tangerines Pancake</td>
					<td>2</td>
					<td class="prep"><span></span>Prep</td>
					<td>
						<img src="{% static '/images/rupee.png' %}" alt="" />249
					</td>
				</tr>

			</table>
			<div class="total">
				<h4>
					<img src="{% static '/images/rupee.png' %}" alt="" />5000
				</h4>
			</div>
		</div> -->
	</main>

	<!-- Orders Page Ends here -->

	<!-- End Main -->
	<!-- ------------------------------------------- -->
	<!-- Start Footer -->

	<footer>
		<div class="footerGrid">
			<li id="homeSlide" class="footerTab " onclick="footerSwitch(this, 'homePage')">
				<img src="{% static '/images/home.png' %}" alt="" />
				<img src="{% static '/images/home1.png' %}" alt="" />
				<span>Home</span>
			</li>
			<li id="exploreSlide" class="footerTab" onclick="footerSwitch(this, 'explorePage');">
				<img src="{% static '/images/explore.png' %}" alt="" />
				<img src="{% static '/images/explore1.png' %}" alt="" />
				<span>Explore</span>
			</li>
			<li id="chatSlide" class="footerTab active" onclick="footerSwitch(this, 'chatBotPage'); ChatOpen()">
				<img src="{% static '/images/chat.png' %}" alt="" />
				<img src="{% static '/images/chat1.png' %}" alt="" />
				<span>Chat</span>
			</li>
			<a href="{% url 'main:order' %}">
				<li id="orderSlide" class="footerTab" onclick="footerSwitch(this, 'orderPage')">
					<img src="{% static '/images/ordered.png' %}" alt="" />
					<img src="{% static '/images/ordered1.png' %}" alt="" />
					<span>Order</span>
				</li>
			</a>
		</div>
	</footer>

	<!-- End Footer -->
	<!-- ------------------------------------------- -->
	<!-- Add JS Files Here -->

	<script src="https://code.jquery.com/jquery-3.5.1.min.js"
		integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

	<script>all_dishes = "{{ all_dishes }}";</script>
	<script src="{% static 'js/main.js' %}"></script>
	<script src="{% static 'js/search.js' %}"></script>

	<script>
		let yesBtn = document.getElementById("yesBtn");
		let noBtn = document.getElementById("noBtn");

		function yes_message() {
			let message = "Deal";
			fetch("{% url 'chatroom-ajax' other_user.id %}",
				{
					method: "POST",
					credentials: 'same-origin',
					headers: {
						"Content-Type": 'application/json',
						'X-CSRFToken': '{{ csrf_token }}'
					},
					body: JSON.stringify(message)
				}
			).then(e => e.json()).then(messages => {
				for (message of messages) {
					construct_message(message);
				}
			});
		}

		function no_message() {
			let message = "No Deal";
			fetch("{% url 'chatroom-ajax' other_user.id %}",
				{
					method: "POST",
					credentials: 'same-origin',
					headers: {
						"Content-Type": 'application/json',
						'X-CSRFToken': '{{ csrf_token }}'
					},
					body: JSON.stringify(message)
				}
			).then(e => e.json()).then(messages => {
				for (message of messages) {
					construct_message(message);
				}
			});
		}

		/*
		function bot_message(msg) {
			let message = msg;
			fetch("{% url 'main:bot-message' other_user.id %}",
				{
					method: "POST",
					credentials: 'same-origin',
					headers: {
						"Content-Type": 'application/json',
						'X-CSRFToken': '{{ csrf_token }}'
					},
					body: JSON.stringify(message)
				}
			).then(e => e.json()).then(messages => {
				messages[0].sender = "foodmarket";
				messages[0].className = "bot";
			});
		}
		*/

		function load_messages() {
			fetch("{% url 'chatroom-ajax' other_user.id %}")
				.then(e => e.json()).then(messages => {
					for (message of messages) {
						construct_message(message);
					}
				})
		}

		function construct_message(message) {
			let messages_container = document.querySelector(".messages-area");
			if (message.sent) {
				className = "user_chat"
			}
			$('.user_chat').attr('data-attr', 'Mr. Green');

			let div = document.createElement("div");
			let br = document.createElement("br");
			console.log(message.className);
			div.classList.add("chat", message.className);
			div.innerHTML = `
							<p>${message.message}</p>
	        `
			messages_container.appendChild(div);
			messages_container.appendChild(br);
			div.scrollIntoView()
		}
		yesBtn.addEventListener('click', yes_message);
		noBtn.addEventListener('click', no_message);

		function cssChat() {
			$('.user_chat').attr('data-attr', '{{ request_user }}');
		}

		function disableButton() {
			var chatButtons = document.getElementById("chatButtons");
			chatButtons.classList.add("disable")
		}

		setInterval(cssChat, 100);
		setInterval(load_messages, 3500);
		// disableButton()

		// bot_message("Hey")
	</script>



	<!-- End JS -->
</body>

</html>

<!-- #A9A9A9 -->